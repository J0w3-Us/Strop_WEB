<!-- Modal Crear Proyecto -->
<div class="modal-overlay" id="modalCrearProyecto">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Crear Nuevo Proyecto</h2>
      <button
        class="modal-close"
        onclick="closeModalProyecto('modalCrearProyecto')">&times;</button
      >
    </div>
    <div class="modal-body">
      <form id="formCrearProyecto">
        <div class="form-group">
          <label for="titulo">Nombre del Proyecto *</label>
          <input
            type="text"
            id="titulo"
            name="titulo"
            class="form-input"
            placeholder="Residencial del Valle"
            required
          />
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="tipo">Tipo de Proyecto *</label>
            <select id="tipo" name="tipo" class="form-select" required>
              <option value="">Selecciona un tipo...</option>
              <option value="Residencial">Residencial</option>
              <option value="Comercial">Comercial</option>
              <option value="Oficinas">Oficinas</option>
              <option value="Infraestructura">Infraestructura</option>
              <option value="Industrial">Industrial</option>
            </select>
          </div>
          <div class="form-group">
            <label for="presupuesto">Presupuesto</label>
            <input
              type="text"
              id="presupuesto"
              name="presupuesto"
              class="form-input"
              placeholder="$1,000,000"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="fechaInicio">Fecha de Inicio</label>
            <input
              type="date"
              id="fechaInicio"
              name="fechaInicio"
              class="form-input"
            />
          </div>
          <div class="form-group">
            <label for="fechaFin">Fecha de Finalización</label>
            <input
              type="date"
              id="fechaFin"
              name="fechaFin"
              class="form-input"
            />
          </div>
        </div>

        <div class="form-group">
          <label for="ubicacion">Ubicación</label>
          <input
            type="text"
            id="ubicacion"
            name="ubicacion"
            class="form-input"
            placeholder="Madrid, España"
          />
        </div>

        <div class="form-group">
          <label for="responsable">Responsable del Proyecto</label>
          <select id="responsable" name="responsable" class="form-select">
            <option value="">Selecciona un responsable...</option>
            <option value="1">Carlos Rivera</option>
            <option value="2">Ana Torres</option>
            <option value="3">Luis García</option>
            <option value="4">Javier Martín</option>
          </select>
        </div>

        <div class="form-group">
          <label for="descripcion">Descripción</label>
          <textarea
            id="descripcion"
            name="descripcion"
            class="form-textarea"
            placeholder="Describe el proyecto..."></textarea>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button
        type="button"
        class="btn-cancel"
        onclick="closeModalProyecto('modalCrearProyecto')">Cancelar</button
      >
      <button type="submit" form="formCrearProyecto" class="btn-submit"
        >Crear Proyecto</button
      >
    </div>
  </div>
</div>

<script>
  // Declare global functions
  declare global {
    interface Window {
      openModalProyecto: (modalId: string) => void;
      closeModalProyecto: (modalId: string) => void;
    }
  }

  window.openModalProyecto = function (modalId: string) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.add("show");
      document.body.style.overflow = "hidden";
    }
  };

  window.closeModalProyecto = function (modalId: string) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.remove("show");
      document.body.style.overflow = "";
    }
  };

  // Close modal on overlay click
  document.addEventListener("DOMContentLoaded", function () {
    const modalOverlays =
      document.querySelectorAll<HTMLElement>(".modal-overlay");
    modalOverlays.forEach((overlay) => {
      overlay.addEventListener("click", function (e: Event) {
        if (e.target === overlay) {
          overlay.classList.remove("show");
          document.body.style.overflow = "";
        }
      });
    });

    // Handle form submission
    const form = document.getElementById(
      "formCrearProyecto"
    ) as HTMLFormElement | null;
    if (form) {
      form.addEventListener("submit", function (e) {
        e.preventDefault();
        const formData = new FormData(form);
        const data = Object.fromEntries(formData);
        console.log("Crear proyecto:", data);
        // TODO: Enviar datos al API
        alert(`Proyecto "${data.titulo}" creado exitosamente!`);
        window.closeModalProyecto("modalCrearProyecto");
        form.reset();
      });
    }
  });
</script>
